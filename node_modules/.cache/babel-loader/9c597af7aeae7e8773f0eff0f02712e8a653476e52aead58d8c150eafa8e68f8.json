{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import{useLocation}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function VehicleUpdateForm(){const location=useLocation();const searchParams=new URLSearchParams(location.search);const id=searchParams.get('id');const vehicleId=id;const[formData,setFormData]=useState({BRAND:'',MODEL:'',YEAR:'',COLOR:'',placa:'','numero economico':'',vim:'',asientos:'',seguro:'','segure numebr':''});const[modifiedFields,setModifiedFields]=useState({});// Estado para almacenar los campos modificados\nconst[emptyFields,setEmptyFields]=useState([]);const[successMessage,setSuccessMessage]=useState('');const[loading,setLoading]=useState(false);useEffect(()=>{const fetchVehicleData=async()=>{try{const response=await axios.get(\"https://www.api.merakimx.mx/gpd/vehicle/ads/\".concat(vehicleId));const vehicleData=response.data;setFormData(vehicleData);}catch(error){console.error('Error al obtener los datos del vehículo:',error);}};fetchVehicleData();},[vehicleId]);const handleChange=e=>{const{name,value}=e.target;setFormData({...formData,[name]:value});setModifiedFields({...modifiedFields,[name]:value});if(emptyFields.includes(name)&&value!==''){setEmptyFields(emptyFields.filter(field=>field!==name));}};const handleSubmit=async e=>{e.preventDefault();const formDataWithoutIdAndStatus=Object.fromEntries(Object.entries(modifiedFields).filter(_ref=>{let[key]=_ref;return key!=='_id'&&key!=='status';}));const emptyFieldsArray=Object.keys(formDataWithoutIdAndStatus).filter(key=>formDataWithoutIdAndStatus[key]==='');if(emptyFieldsArray.length>0){setEmptyFields(emptyFieldsArray);}else{setEmptyFields([]);setLoading(true);try{const response=await axios.put(\"https://www.api.merakimx.mx/gpd/vehicle/ad/\".concat(vehicleId),formDataWithoutIdAndStatus);console.log(response);setSuccessMessage('¡Los datos del formulario se actualizaron correctamente!');setTimeout(()=>{window.location.href='/';},2000);}catch(error){console.error('Error al enviar los datos del formulario:',error);}finally{setLoading(false);}}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{style:{textAlign:'center'},children:\"Actualizaci\\xF3n de Veh\\xEDculo\"}),/*#__PURE__*/_jsxs(\"div\",{style:{margin:'7%'},children:[loading?/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'center'},children:/*#__PURE__*/_jsx(\"p\",{children:\"Enviando datos...\"})}):/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,style:{display:\"grid\",gridTemplateColumns:\"repeat(auto-fill, minmax(300px, 1fr))\",gap:\"1rem\"},children:[Object.entries(formData).map(_ref2=>{let[key,value]=_ref2;return(// Excluye _id y status del mapeo\nkey!=='_id'&&key!=='status'&&/*#__PURE__*/_jsxs(\"div\",{style:{display:\"grid\",gridTemplateRows:\"auto 1fr\",gap:\"0.5rem\"},children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:key,children:[key,emptyFields.includes(key)&&\" *\",\":\"]}),key==='YEAR'||key==='asientos'?/*#__PURE__*/_jsx(\"input\",{type:\"number\",id:key,name:key,value:value,onChange:handleChange,required:true,style:{height:'25px'}}):/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:key,name:key,value:value,onChange:handleChange,required:true,style:{height:'25px'}}),emptyFields.includes(key)&&/*#__PURE__*/_jsx(\"span\",{style:{color:'red'},children:\"Campo requerido\"})]},key));}),/*#__PURE__*/_jsx(\"div\",{style:{gridColumn:\"1 / -1\",textAlign:\"center\"},children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",style:{color:'white',textDecoration:'none',padding:'10px 20px',borderRadius:'5px',backgroundColor:'#007bff',border:'aliceblue'},children:\"Actualizar\"})})]}),successMessage&&/*#__PURE__*/_jsx(\"div\",{style:{color:'green',marginTop:'10px'},children:successMessage})]})]});}export default VehicleUpdateForm;","map":{"version":3,"names":["React","useState","useEffect","axios","useLocation","jsx","_jsx","jsxs","_jsxs","VehicleUpdateForm","location","searchParams","URLSearchParams","search","id","get","vehicleId","formData","setFormData","BRAND","MODEL","YEAR","COLOR","placa","vim","asientos","seguro","modifiedFields","setModifiedFields","emptyFields","setEmptyFields","successMessage","setSuccessMessage","loading","setLoading","fetchVehicleData","response","concat","vehicleData","data","error","console","handleChange","e","name","value","target","includes","filter","field","handleSubmit","preventDefault","formDataWithoutIdAndStatus","Object","fromEntries","entries","_ref","key","emptyFieldsArray","keys","length","put","log","setTimeout","window","href","children","style","textAlign","margin","onSubmit","display","gridTemplateColumns","gap","map","_ref2","gridTemplateRows","htmlFor","type","onChange","required","height","color","gridColumn","textDecoration","padding","borderRadius","backgroundColor","border","marginTop"],"sources":["/Users/rodrigo/Desktop/traxiapp/src/components/vehicle/vehicleUpdateForm.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { useLocation } from 'react-router-dom';\n\nfunction VehicleUpdateForm() {\n    const location = useLocation();\n    const searchParams = new URLSearchParams(location.search);\n    const id = searchParams.get('id');\n    const vehicleId = id;\n\n    const [formData, setFormData] = useState({\n        BRAND: '',\n        MODEL: '',\n        YEAR: '',\n        COLOR: '',\n        placa: '',\n        'numero economico': '',\n        vim: '',\n        asientos: '',\n        seguro: '',\n        'segure numebr': ''\n    });\n\n    const [modifiedFields, setModifiedFields] = useState({}); // Estado para almacenar los campos modificados\n    const [emptyFields, setEmptyFields] = useState([]);\n    const [successMessage, setSuccessMessage] = useState('');\n    const [loading, setLoading] = useState(false);\n\n    useEffect(() => {\n        const fetchVehicleData = async () => {\n            try {\n                const response = await axios.get(`https://www.api.merakimx.mx/gpd/vehicle/ads/${vehicleId}`);\n                const vehicleData = response.data;\n                setFormData(vehicleData);\n            } catch (error) {\n                console.error('Error al obtener los datos del vehículo:', error);\n            }\n        };\n\n        fetchVehicleData();\n    }, [vehicleId]);\n\n    const handleChange = (e) => {\n        const { name, value } = e.target;\n        setFormData({\n            ...formData,\n            [name]: value\n        });\n        setModifiedFields({\n            ...modifiedFields,\n            [name]: value\n        });\n        if (emptyFields.includes(name) && value !== '') {\n            setEmptyFields(emptyFields.filter(field => field !== name));\n        }\n    };\n\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n        const formDataWithoutIdAndStatus = Object.fromEntries(\n            Object.entries(modifiedFields).filter(([key]) => key !== '_id' && key !== 'status')\n        );\n        const emptyFieldsArray = Object.keys(formDataWithoutIdAndStatus).filter(key => formDataWithoutIdAndStatus[key] === '');\n        if (emptyFieldsArray.length > 0) {\n            setEmptyFields(emptyFieldsArray);\n        } else {\n            setEmptyFields([]);\n            setLoading(true);\n            try {\n                const response = await axios.put(`https://www.api.merakimx.mx/gpd/vehicle/ad/${vehicleId}`, formDataWithoutIdAndStatus);\n                console.log(response)\n                setSuccessMessage('¡Los datos del formulario se actualizaron correctamente!');\n                setTimeout(() => {\n                    window.location.href = '/';\n                }, 2000);\n            } catch (error) {\n                console.error('Error al enviar los datos del formulario:', error);\n            } finally {\n                setLoading(false);\n            }\n        }\n    };\n\n\n    return (\n        <div>\n            <h2 style={{ textAlign: 'center' }}>Actualización de Vehículo</h2>\n            <div style={{ margin: '7%' }}>\n                {loading ? (\n                    <div style={{ textAlign: 'center' }}>\n                        <p>Enviando datos...</p>\n                    </div>\n                ) : (\n                    <form\n                        onSubmit={handleSubmit}\n                        style={{\n                            display: \"grid\",\n                            gridTemplateColumns: \"repeat(auto-fill, minmax(300px, 1fr))\",\n                            gap: \"1rem\",\n                        }}\n                    >\n                        {Object.entries(formData).map(([key, value]) => (\n                            // Excluye _id y status del mapeo\n                            key !== '_id' && key !== 'status' && (\n                                <div key={key} style={{ display: \"grid\", gridTemplateRows: \"auto 1fr\", gap: \"0.5rem\" }}>\n                                    <label htmlFor={key}>{key}{emptyFields.includes(key) && \" *\"}:</label>\n                                    {key === 'YEAR' || key === 'asientos' ? (\n                                        <input\n                                            type=\"number\"\n                                            id={key}\n                                            name={key}\n                                            value={value}\n                                            onChange={handleChange}\n                                            required\n                                            style={{ height: '25px' }}\n                                        />\n                                    ) : (\n                                        <input\n                                            type=\"text\"\n                                            id={key}\n                                            name={key}\n                                            value={value}\n                                            onChange={handleChange}\n                                            required\n                                            style={{ height: '25px' }}\n                                        />\n                                    )}\n                                    {emptyFields.includes(key) && <span style={{ color: 'red' }}>Campo requerido</span>}\n                                </div>\n                            )\n                        ))}\n\n                        <div style={{ gridColumn: \"1 / -1\", textAlign: \"center\" }}>\n                            <button type=\"submit\" style={{ color: 'white', textDecoration: 'none', padding: '10px 20px', borderRadius: '5px', backgroundColor: '#007bff', border: 'aliceblue', }}>Actualizar</button>\n                        </div>\n                    </form>\n                )}\n                {successMessage && (\n                    <div style={{ color: 'green', marginTop: '10px' }}>\n                        {successMessage}\n                    </div>\n                )}\n            </div>\n        </div>\n    );\n}\n\nexport default VehicleUpdateForm;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}